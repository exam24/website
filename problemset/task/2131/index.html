<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link rel="stylesheet " type="text/css" href="../../../cses.css@13.css" id="styles">
  <link rel="stylesheet alternate" type="text/css" href="https://cses.fi/cses-dark.css?13" id="styles-dark">
  <meta name="theme-color" content="white" id="theme-color">
  <script type="application/json" id="darkmode-enabled">false</script>
  <script src="../../../ui.js"></script>
  <link rel="stylesheet" type="text/css" href="../../../lib/fontawesome/css/all.min.css">
</head>
<body class="with-sidebar ">
  <div class="header">
    <div>
      <a href="https://cses.fi/" class="logo"><img src="../../../logo.png@1" alt="CSES"></a>
      <a class="menu-toggle" onclick="document.body.classList.toggle('menu-open');">
        <i class="fas fa-bars"></i>
      </a>
      <div class="controls">
                <a class="account" href="https://cses.fi/login">Login</a>
        <span>&mdash;</span>
                        <a href="https://cses.fi/darkmode" title="Toggle dark mode" onclick="return toggle_theme()"><i aria-label="Dark mode" class="fas fa-adjust"></i><span>Dark mode</span></a>
              </div>
    </div>
  </div>
  <div class="skeleton">

  <div class="navigation">
    <div class="title-block">
      <h3><a href="../../list/index.html">CSES Problem Set</a></h3>
      <h1>Grid Puzzle II</h1>
<ul class="nav">
<li><a href="index.html" class="current">Task</a></li>
<li><a href="../../stats/2131/index.html" >Statistics</a></li>
</ul>
    </div>
    <div class="sidebar"></div>
  </div>

  <div class="content-wrapper">

    <div class="content">


<title>CSES - Grid Puzzle II</title><link rel="stylesheet" href="../../../lib/katex/katex.min.css">
<script defer src="../../../lib/katex/katex.min.js"></script>
<script defer src="../../../lib/katex/contrib/copy-tex.min.js"></script>
<script defer src="../../../lib/google-code-prettify/run_prettify.js"></script>
<script>
addEventListener("DOMContentLoaded", function (e) {
    const mathElements = document.getElementsByClassName("math");
    const macros = {};
    for (let element of mathElements) {
        katex.render(element.textContent, element, {
            displayMode: element.classList.contains("display"),
            throwOnError: false,
            globalGroup: true,
            macros,
        });
    }
});
</script>
<ul class="task-constraints">
<li><b>Time limit:</b> 1.00 s</li>
<li><b>Memory limit:</b> 512 MB</li>
</ul>
<input type="hidden" name="course" value="problemset">
<input type="hidden" name="task" value="2131">
<div class="md"><p>There is an <span class="math inline">n \times n</span> grid whose each square has some number of coins in it.</p>
<p>You know for each row and column how many squares you must choose from that row or column. You get all coins from every square you choose. What is the maximum number of coins you can collect and how could you choose the squares so that the given conditions are satisfied?</p>
<h1 id="input">Input</h1>
<p>The first input line has an integer <span class="math inline">n</span>: the size of the grid. The rows and columns are numbered <span class="math inline">1,2,\dots,n</span>.</p>
<p>The next line has <span class="math inline">n</span> integers <span class="math inline">a_1,a_2,\ldots,a_n</span>: You must choose exactly <span class="math inline">a_i</span> squares from the <span class="math inline">i</span>th row.</p>
<p>The next line has <span class="math inline">n</span> integers <span class="math inline">b_1,b_2,\ldots,b_n</span>: You must choose exactly <span class="math inline">b_j</span> squares from the <span class="math inline">j</span>th column.</p>
<p>Finally, there are <span class="math inline">n</span> lines describing the grid. You can assume that the sums of <span class="math inline">a_1,a_2,\ldots,a_n</span> and <span class="math inline">b_1,b_2,\ldots,b_n</span> are equal.</p>
<h1 id="output">Output</h1>
<p>First print an integer <span class="math inline">k</span>: the maximum number of coins you can collect. After this print <span class="math inline">n</span> lines describing which squares you choose (<code>X</code> means that you choose a square, <code>.</code> means that you don't choose it).</p>
<p>If it is not possible to satisfy the conditions print only <span class="math inline">-1</span>.</p>
<h1 id="constraints">Constraints</h1>
<ul>
<li><span class="math inline">1 \le n \le 50</span></li>
<li><span class="math inline">0 \le a_i \le n</span></li>
<li><span class="math inline">0 \le b_j \le n</span></li>
<li><span class="math inline">0 \le c_{ij} \le 1000</span></li>
</ul>
<h1 id="example">Example</h1>
<p>Input:</p>
<pre>5
0 1 3 2 0
1 2 2 0 1
2 5 1 5 1
0 2 5 1 2
3 8 9 3 5
1 4 3 7 3
0 3 6 2 8
</pre>
<p>Output:</p>
<pre>32
.....
..X..
.XX.X
XX...
.....
</pre></div>    </div>
    <div class="nav sidebar">
<h4>Additional Problems</h4>...
<a  href="../2180.html">Coin Arrangement<span class="task-score icon "></span></a><a  href="../2176.html">Counting Bishops<span class="task-score icon "></span></a><a  href="../2432.html">Grid Puzzle I<span class="task-score icon "></span></a><a class="current" href="../2131.html">Grid Puzzle II<span class="task-score icon "></span></a><a  href="../1080.html">Empty String<span class="task-score icon "></span></a><a  href="../1078.html">Grid Paths<span class="task-score icon "></span></a><a  href="../2115.html">Bit Substrings<span class="task-score icon "></span></a><a  href="../2075.html">Reversal Sorting<span class="task-score icon "></span></a>...
<hr />